*** Settings ***
Resource          ../../../Config/LocalConfig.txt
Resource          Resource/PageKeywords/Emerald_ServiceCenter.txt

*** Test Cases ***
[F7_EmeraldWebMobile_2_1_Y_1_1] Verify Serenade Touchpoint open GPS on Mobile
    [Documentation]    *Owner* : Oum
    ...    Call Free to Call Center
    ...
    ...    *Pre-requisite*
    ...    -Serenade Emerald Customer
    ...    - Ntype 3PE :
    ...    - URL : https://10.104.249.46/WelcomeToSerenade
    ...
    ...    *Test Step*
    ...    '1.เปิดลิ้งค์ไปที่เบราซ์เซอร์ https://10.104.240.249/WelcomeToSerenade
    ...    2.ระบบแสดงหน้าเว็บ Serenade Digital Welcome Package
    ...    3.Login เข้าสู่ระบบ
    ...    4. เลื่อนมาที่หน้า ช่องทางติดต่อพิเศษ Serenade Touchpoint
    ...    5. แสดงรูปสถานที่ศูนย์บริการ Serenade Touchpoint
    ...    6. คลิก ปุ่ม "คลิก" เพื่อค้นหาศูนย์บริการ
    ...    7. ตรวจสอบว่าสามารถ redirect ไปยังเว็บไซต์แสดงรายละเอียดศูนย์บริการเพิ่มเติมได้ [1]
    ...    8. ตรวจสอบหน้าเว็บ [2]
    ...    9. จับภาพหน้าจอ
    ...
    ...    *Expected Result*
    ...    [1] ตรวจสอบ URL
    ...    http://www.ais.co.th/servicecenter/
    ...
    ...    [2] ตรวจสอบหน้าเว็บ
    ...    - โลโก้ AIS
    ...    - banner (ร่วมตอบแบบสอบถาม ลุ้นรับพรีเมี่ยมน้องอุ่นใจ)
    ...    - AIS Shop
    &{#dict_device_name}=    Create Dictionary
    &{#dict_device_name}=    Take And Define Virtual Local Configuration    ${#dict_device_name}    ${lo_DigitalSerenade_WebMobile_Prod_local_config_file_path}    virtual_device_1    ${ar_TAKE_TIMEOUT}    ${ar_NType}=include
    ${Number}    Get From Dictionary    ${virtual_device_1_Number}    ${ar_NType}
    Open Browser Serenade    ${URLSerenade}    ${virtual_device_1_SN}    ${virtual_device_1_IPChromeDriver}    ${ar_LANG}
    Login Serenade    ${virtual_device_1_IPAppium}    ${virtual_device_1_SN}    ${virtual_device_1_Platfrom_Name}    ${virtual_device_1_Platfrom_Version}    ${Number}    false
    Scroll Web To Element    ${SerenadeTouchpoint}
    sleep    10
    Web Element Text Should Be    ${SerenadeTouchpoint}    ${lblSerenadeTouchpoint}
    Scroll Web To Element    ${PicSerenadeTouchpoint}
    sleep    10
    Web Element Should Be Visible    ${PicSerenadeTouchpoint}
    Web Capture Screen At Verify Point    SerenadeTouchpoint
    Click Web Element    ${PicSerenadeTouchpoint}
    sleep    10
    Select Window    url=${ServiceCenterLink}
    Location Should Be    ${ServiceCenterLink}
    Web Element Should Be Visible    ${LogoAIS}
    Web Element Text Should Be    ${ContainEntertainment}    ${lblContainEntertainment}
    Mobile Capture Screen At Verify Point    SerenadeTouchpoint in other tab
    [Teardown]    Keywords For Teardown    ${#dict_device_name}

[F7_EmeraldWebMobile_2_1_Y_1_2] Verify Serenade Touchpoint close GPS on Mobile
    &{#dict_device_name}=    Create Dictionary
    &{#dict_device_name}=    Take And Define Virtual Local Configuration    ${#dict_device_name}    ${lo_DigitalSerenade_WebMobile_Prod_local_config_file_path}    virtual_device_1    ${ar_TAKE_TIMEOUT}    ${ar_NType}=include
    ${Number}    Get From Dictionary    ${virtual_device_1_Number}    ${ar_NType}
    Open Browser Serenade    ${URLSerenade}    ${virtual_device_1_SN}    ${virtual_device_1_IPChromeDriver}
    Login Serenade    ${virtual_device_1_IPAppium}    ${virtual_device_1_SN}    ${virtual_device_1_Platfrom_Name}    ${virtual_device_1_Platfrom_Version}    ${Number}    false
    Scroll Web To Element    ${PicSerenadeTouchpoint}
    sleep    10
    Web Element Should Be Visible    ${PicSerenadeTouchpoint}
    Web Element Should Be Visible    ${SearchServiceCenter}
    Web Capture Screen At Verify Point    SerenadeTouchpointII
    Click Web Element    ${AISTouchPointClick}
    sleep    10
    Select Window    url=${SearchServiceCenterLink}
    Location Should Be    ${SearchServiceCenterLink}
    Web Element Text Should Be    ${AISShop}    ${lblAISShop}
    Web Element Text Should Be    ${Bangkok}    ${lblBangkok}
    Web Capture Screen At Verify Point    SerenadeTouchpointII in other tab
    [Teardown]    Keywords For Teardown    ${#dict_device_name}

[F7_EmeraldWebMobile_2_1_Y_1_3] Verify Serenade Touchpoint nearby and open GPS on Mobile
    &{#dict_device_name}=    Create Dictionary
    &{#dict_device_name}=    Take And Define Virtual Local Configuration    ${#dict_device_name}    ${lo_DigitalSerenade_WebMobile_Prod_local_config_file_path}    virtual_device_1    ${ar_TAKE_TIMEOUT}    ${ar_NType}=include
    ${Number}    Get From Dictionary    ${virtual_device_1_Number}    ${ar_NType}
    Open Browser Serenade    ${URLSerenade}    ${virtual_device_1_SN}    ${virtual_device_1_IPChromeDriver}
    Login Serenade    ${virtual_device_1_IPAppium}    ${virtual_device_1_SN}    ${virtual_device_1_Platfrom_Name}    ${virtual_device_1_Platfrom_Version}    ${Number}    false
    Scroll Web To Element    ${PicSerenadeTouchpoint}
    sleep    10
    Web Element Should Be Visible    ${PicSerenadeTouchpoint}
    Web Element Should Be Visible    ${MapSerenadeTouchpoint}
    Web Capture Screen At Verify Point    SerenadeTouchpointIII
    [Teardown]    Keywords For Teardown    ${#dict_device_name}
